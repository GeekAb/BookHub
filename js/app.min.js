var App={appBase:null,appMode:null,apiBase:null,authToken:null,globalPollTime:3e4,ajaxRequestArray:{},appUrls:{bookList:""},apiURLs:{book:{list:{url:"https://capillary.0x10.info/api/books?type=json&query=list_books",method:"GET"}}},init:function(){},buildUrl:function(e){var t=e.split("-");return t.length>1?App.apiURLs[t[0]][t[1]]:App.apiURLs[e]},callAPI:function(e,t,r){var o=App.buildUrl(e),l=App.apiBase+o.url;if((""!=t&&"GET"===o.method||"DELETE"===o.method)&&(l+=t),(""!=t&&"PATCH"===o.method||"POST"===o.method)&&"string"==typeof t){var a=t.split("?");console.table(a),a.length>1?(l+=a[0],t=a[1]):(l+=a[0],console.log(r),t="undefined"!=typeof r.data?r.data:{})}var i=$.ajax({url:l,data:"GET"===o.method||"DELETE"===o.method?"":t,type:o.method,dataType:"undefined"!=typeof r.dataType?r.dataType:"JSON",beforeSend:function(e){void 0!==r&&void 0!==r.authCheck&&r.authCheck&&App.setHeader(e)},success:function(t){void 0!==r&&void 0!==r.successCallback&&r.successCallback(t)},error:function(e,t,o){403==e.status&&"FORBIDDEN"==e.statusText?window.location=App.appUrls.login:401==e.status&&"UNAUTHORIZED"==e.statusText?r.errorCallback(e):void 0!==r&&void 0!==r.errorCallback&&r.errorCallback(e.responseJSON,e.status),console.log("Error: "+o),console.log("Status: "+t),console.log(e),console.log(e.responseJSON)},complete:function(){void 0!==r&&void 0!==r.completeCallback&&r.completeCallback(e,t,r)},timeout:6e5});r.requestName&&(App.ajaxRequestArray[r.requestName]=i)},setHeader:function(e){e.withCredentials=!0,e.setRequestHeader("Authorization","Token  "+window.localStorage.token)},createLocalStorage:function(){window.localStorage={length:0,key:function(e){return unescape(document.cookie.replace(/\s*\=(?:.(?!;))*$/,"").split(/\s*\=(?:[^;](?!;))*[^;]?;\s*/)[e])},getItem:function(e){return e&&this.hasOwnProperty(e)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},setItem:function(e,t){e&&(document.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/",this.length=document.cookie.match(/\=/g).length)},removeItem:function(e){e&&this.hasOwnProperty(e)&&(document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",this.length--)},hasOwnProperty:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},window.localStorage.length=(document.cookie.match(/\=/g)||window.localStorage).length}};App.init({});