var App={appBase:null,appMode:null,apiBase:"https://capillary.0x10.info/api/",authToken:null,globalPollTime:3e4,ajaxRequestArray:{},lastVisited:"",totalBooks:0,bookmarked:0,bookmarkedList:[],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],apiURLs:{book:{list:{url:"books",method:"GET"}}},init:function(){App.setupLocalStorage()},setupLocalStorage:function(){"undefined"!=typeof window.localStorage.bookmarked&&0!=window.localStorage.bookmarked?App.bookmarked=parseInt(window.localStorage.bookmarked):window.localStorage.bookmarked=App.bookmarked,"undefined"!=typeof window.localStorage.lastVisited&&""!=window.localStorage.lastVisited&&$(".lastvisited small").html("Last visited on "+window.localStorage.lastVisited);var e=new Date;window.localStorage.lastVisited=e.getDate()+" "+App.monthNames[e.getMonth()]+" "+e.getFullYear(),"undefined"!=typeof window.localStorage.bookmarkedList&&""!=window.localStorage.bookmarkedList&&(App.bookmarkedList=window.localStorage.bookmarkedList.split(","))},buildUrl:function(e){var t=e.split("-");return t.length>1?App.apiURLs[t[0]][t[1]]:App.apiURLs[e]},callAPI:function(e,t,o){var i=App.buildUrl(e),n=App.apiBase+i.url;if((""!=t&&"GET"===i.method||"DELETE"===i.method)&&(n+=t),(""!=t&&"PATCH"===i.method||"POST"===i.method)&&"string"==typeof t){var s=t.split("?");console.table(s),s.length>1?(n+=s[0],t=s[1]):(n+=s[0],console.log(o),t="undefined"!=typeof o.data?o.data:{})}var l=$.ajax({url:n,data:"GET"===i.method||"DELETE"===i.method?"":t,type:i.method,dataType:"undefined"!=typeof o.dataType?o.dataType:"JSON",beforeSend:function(e){void 0!==o&&void 0!==o.authCheck&&o.authCheck&&App.setHeader(e)},success:function(t){void 0!==o&&void 0!==o.successCallback&&o.successCallback(t)},error:function(e){403==e.status&&"FORBIDDEN"==e.statusText?window.location=App.appUrls.login:401==e.status&&"UNAUTHORIZED"==e.statusText?o.errorCallback(e):void 0!==o&&void 0!==o.errorCallback&&o.errorCallback(e.responseJSON,e.status)},complete:function(){void 0!==o&&void 0!==o.completeCallback&&o.completeCallback(e,t,o)},timeout:6e5});o.requestName&&(App.ajaxRequestArray[o.requestName]=l)},setHeader:function(e){e.withCredentials=!0,e.setRequestHeader("Authorization","Token  "+window.localStorage.token)},createLocalStorage:function(){window.localStorage={length:0,key:function(e){return unescape(document.cookie.replace(/\s*\=(?:.(?!;))*$/,"").split(/\s*\=(?:[^;](?!;))*[^;]?;\s*/)[e])},getItem:function(e){return e&&this.hasOwnProperty(e)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},setItem:function(e,t){e&&(document.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/",this.length=document.cookie.match(/\=/g).length)},removeItem:function(e){e&&this.hasOwnProperty(e)&&(document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",this.length--)},hasOwnProperty:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},window.localStorage.length=(document.cookie.match(/\=/g)||window.localStorage).length}};